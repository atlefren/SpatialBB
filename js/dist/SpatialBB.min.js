/*! SpatialBB 14-05-2013 */
var SpatialBB=window.SpatialBB||{};(function(i){"use strict";i.MissingPositionError=function(i){this.name="MissingPositionError",this.message=i||"Missing Position"},i.MissingPositionError.prototype=Error(),i.MissingPositionError.prototype.constructor=i.MissingPositionError})(SpatialBB);var SpatialBB=window.SpatialBB||{};(function(i){"use strict";i.MarkerCollection=Backbone.Collection.extend({model:i.MarkerModel,initialize:function(){this.layerGroup=new L.LayerGroup,this.on("add",this.modelAdded,this),this.on("remove",this.modelRemoved,this),this.on("reset",this.collectionReset,this)},getLayerGroup:function(){return this.layerGroup},modelAdded:function(i){var t=i.getMarker();t||(i.createMarker(i.parsePosition()),t=i.getMarker()),this.layerGroup.addLayer(t)},modelRemoved:function(i){var t=i.getMarker();t&&this.layerGroup.removeLayer(t)},collectionReset:function(){this.layerGroup.clearLayers(),this.each(function(i){this.layerGroup.addLayer(i.getMarker())},this)}})})(SpatialBB);var SpatialBB=window.SpatialBB||{};(function(i){"use strict";i.MarkerModel=Backbone.Model.extend({initialize:function(i,t){t=t||{initPos:!0},t.initPos&&this.createMarker(this.parsePosition())},parsePosition:function(){return this.has("position")?{lon:this.get("position").lon||null,lat:this.get("position").lat||null}:null},parse:function(i){return i.position&&this.createMarker(i.position),i},createMarker:function(t){if(!t||!t.lon||!t.lat)throw new i.MissingPositionError;this.marker=new L.Marker([t.lat,t.lon])},getMarker:function(){return this.marker}})})(SpatialBB);